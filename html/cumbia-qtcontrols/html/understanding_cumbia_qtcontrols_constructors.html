<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-qtcontrols: Understanding the cumbia-qtcontrols widgets constructors, sources and targets.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cumbia-qtcontrols<span id="projectnumber">&#160;1.x</span>
   </div>
   <div id="projectbrief">Qt widgets on top of the cumbia C++ library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Understanding the cumbia-qtcontrols widgets constructors, sources and targets. </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_src_cumbia_qtcontrols_widget_constructors"></a> cumbia-qtcontrols widgets have been designed to be parametrized at construction time so that read and write operations can be performed through several different engines. Thanks to a common interface and to the help of engine specific factories, a widget can connect to either one or another engine transparently.</p>
<p >In this chapter, we will discuss the two main constructors you will always find in the cumbia-qtcontrols widget library.</p>
<h1>Readers</h1>
<h2>Constructor with the parent widget, an <em>engine specific</em> Cumbia implementation and a <a class="el" href="classCuControlsReaderFactoryI.html" title="cumbia-qtcontrols reader factory. Creates an instance of a CuControlsReaderA implementation.">CuControlsReaderFactoryI</a> interface.</h2>
<p >Taking <a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel</a> as an example, the constructor is declared as follows:</p>
<blockquote class="doxtable">
<p >&zwj;<a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel(QWidget *w, Cumbia *cumbia, const CuControlsReaderFactoryI &amp;r_fac)</a>; </p>
</blockquote>
<ul>
<li>w is the parent widget, as usual for every Qt widget; </li>
<li>cumbia is a pointer to a Cumbia implementation specific to a given engine, for example CumbiaTango or CumbiaEpics </li>
<li>r_fac is a const reference to an implementation of a <a class="el" href="classCuControlsReaderFactoryI.html" title="cumbia-qtcontrols reader factory. Creates an instance of a CuControlsReaderA implementation.">CuControlsReaderFactoryI</a> interface, such as <a class="elRef" href="../../qumbia-tango-controls/html/classCuTReaderFactory.html">CuTReaderFactory</a> from the qumbia-tango-controls module.</li>
</ul>
<h2>Constructor with the parent widget, <em>CumbiaPool</em> and <em><a class="el" href="classCuControlsFactoryPool.html" title="this class, used in conjunction with CumbiaPool allows to connect to different control system framewo...">CuControlsFactoryPool</a></em>.</h2>
<p ><em>CumbiaPool</em> and <em><a class="el" href="classCuControlsFactoryPool.html" title="this class, used in conjunction with CumbiaPool allows to connect to different control system framewo...">CuControlsFactoryPool</a></em> are two objects that allow mixing together in the same application different engines.</p>
<p >Taking again <a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel</a> as an example, the constructor looks like this:</p>
<blockquote class="doxtable">
<p >&zwj;<a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel(QWidget *w, CumbiaPool *cumbia_pool, const CuControlsFactoryPool &amp;fpool)</a>; </p>
</blockquote>
<ul>
<li>w is the parent widget; </li>
<li>cumbia_pool is a pointer to an object designed to configure the <a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel</a> at runtime according to the source provided for the reader. If CumbiaPool parametrizes <a class="el" href="classQuLabel.html" title="A label derived from Qt QLabel to display boolean values, strings, scalars and even vectors.">QuLabel</a>, Tango and Epics sources can be used together in the same application. </li>
<li>fpool: a const reference to a factory that allocates the appropriate reader depending on the source specified.</li>
</ul>
<h2>Sources</h2>
<p >A source in <em>cumbia</em> is the name (address) of a quantity that can be read.</p>
<p >The name of the source depends on the engine employed, and identifies a connection endpoint, e.g. for Tango a device or server name plus the name of a command or attribute, and for Epics a PV. A couple of examples follow:</p>
<ul>
<li><em>test/device/1/double_scalar</em>: an example of Tango attribute that will be read. </li>
<li><em>controls:current</em>: an epics PV to read from </li>
<li><em>a/b/c-&gt;GetValues(0, 100)</em>: reads a Tango command that receives two input arguments. </li>
<li><em>$1/attribute_name</em>: replaces $1 with the first command line argument of the application, which will be a Tango device name. The attribute <em>attribute_name</em> will be read. </li>
<li><em>$2-&gt;command_name</em>: replaces $2 with the second command line argument of the application, which will be a Tango device name. The command <em>command_name</em> will be read.</li>
</ul>
<h3>Sources to access the Tango database</h3>
<p >In this section we cover source names that allow to fetch properties and other pieces of information from the Tango Database. The <em>cumbia read</em> utility used in the examples allows immediate testing.</p>
<ul>
<li>Domain search: src must end with wildcard: tango://host/port/doma* <div class="fragment"><div class="line">$ cumbia read  tango://ken:20000/seq*</div>
<div class="line">$ * tango://ken:20000/seq*: [16:10:42+0.569857] [string,2] { seq,sequencer }</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Search all families under a given domain: <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/sequencer/</div>
<div class="line">$ * tango://ken:20000/sequencer/: [16:27:33+0.470669] [string,3] { fermi,ps,test }</div>
</div><!-- fragment --> </li>
<li>Search all families under a given domain, with wildcard: <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/sequencer/fe*</div>
<div class="line">$ * tango://ken:20000/sequencer/fe*: [16:29:02+0.798002] [string,1] { fermi }</div>
</div><!-- fragment --> </li>
<li>Search all members under a given domain/family <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/sequencer/fermi/</div>
<div class="line">$ * tango://ken:20000/sequencer/fermi/: [16:30:11+0.886962] [string,2] { test.01,test.02 }</div>
</div><!-- fragment --> </li>
<li>Search all members under a given domain/family, with wildcard: <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/sequencer/test/s*a*</div>
<div class="line">$ * tango://ken:20000/sequencer/test/s*a*: [16:31:42+0.568593] [string,3] { scan1d-test.01,stats-01,stats-02 }</div>
</div><!-- fragment --> </li>
<li>Get a free property from an object in the database <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/#Sequencer#TestList</div>
<div class="line">$ * tango://ken:20000/#Sequencer#TestList: [16:40:17+0.056525] [string,3] { seq/test/launch_super,seq/test/launch_a,seq/test/launch_b }</div>
</div><!-- fragment --> </li>
<li>Get the list of attributes of a device <div class="fragment"><div class="line">$ cumbia read tango://ken:20000/test/device/1/</div>
<div class="line">$ * tango://ken:20000/test/device/1/: [16:44:02+0.281213] [string,62] { ampli,boolean_scalar,double_scalar,double_scalar_rww,double_scalar_w,...</div>
</div><!-- fragment --> </li>
<li>Get device properties <div class="fragment"><div class="line">$ cumbia read &quot;tango://ken:20000/test/device/1(description, helperApplication,values)&quot;</div>
<div class="line">$  * tango://ken:20000/test/device/1(description, helperApplication,values) [11:32:55+0.426527]</div>
<div class="line">   - tango://ken:20000/test/device/1</div>
<div class="line">     description               --&gt; This is a Tango Test device with ,many interesing attributes and commands</div>
<div class="line">     helperApplication         --&gt; atkpanel</div>
<div class="line">     values                    --&gt; 10,20,30,40,50</div>
</div><!-- fragment --> </li>
<li>Get one attribute property <div class="fragment"><div class="line">$ cumbia read cumbia read &quot;tango://hokuto:20000/test/device/1/double_scalar(values)&quot;</div>
<div class="line">$ * tango://hokuto:20000/test/device/1/double_scalar(values) [11:35:45+0.346103]</div>
<div class="line">  - tango://hokuto:20000/test/device/1</div>
<div class="line">    values                    --&gt; 10.1,10.2,10.3,12.0,16.2,80.12,100.1,200.8</div>
</div><!-- fragment --> </li>
<li>Get multiple attribute properties <div class="fragment"><div class="line">$ cumbia read &quot;tango://hokuto:20000/test/device/1/double_scalar(min_value,max_value,min_alarm,max_alarm,format)&quot;</div>
<div class="line">$ * tango://hokuto:20000/test/device/1/double_scalar(min_value,max_value,min_alarm,max_alarm,format) [11:43:02+0.779032]</div>
<div class="line">  - tango://hokuto:20000/test/device/1</div>
<div class="line">    format                    --&gt; %2.3f</div>
<div class="line">    max_alarm                 --&gt; 200</div>
<div class="line">    max_value                 --&gt; 255</div>
<div class="line">    min_alarm                 --&gt; -200</div>
<div class="line">    min_value                 --&gt; -255</div>
<div class="line"> -------------------------------------------------</div>
</div><!-- fragment --> </li>
<li>List all properties of a given class <div class="fragment"><div class="line">$ cumbia read &quot;tango://hokuto:20000/TangoTest(*)&quot;</div>
<div class="line">* tango://hokuto:20000/TangoTest(*) [12:02:44+0.146309]</div>
<div class="line">  -</div>
<div class="line">  - class: TangoTest</div>
<div class="line">  - pattern: &quot;TangoTest(*)&quot;</div>
<div class="line">  - value: Csoglia,cvs_location,cvs_tag,Description,doc_url,helperApplication_old,InheritedFrom,ProjectTitle</div>
<div class="line">  - tango host: hokuto:20000</div>
</div><!-- fragment --> </li>
<li>Fetch class properties <div class="fragment"><div class="line">$ cumbia read &quot;tango://hokuto:20000/TangoTest(ProjectTitle,Description)&quot;</div>
<div class="line">$ * tango://hokuto:20000/TangoTest(ProjectTitle,Description) [12:08:04+0.329729]</div>
<div class="line">  -</div>
<div class="line">    ProjectTitle              --&gt; TANGO Device Server for testing generic clients</div>
<div class="line">    Description               --&gt; A device to test generic clients. It offers a &quot;echo&quot; like command for each TANGO data type (i.e. each command returns an exact copy of &lt;argin&gt;).</div>
</div><!-- fragment --></li>
</ul>
<h1>Writers</h1>
<p >There exists a perfect analogy between the readers and writers parametrization. Taking a <a class="el" href="classQuWriter.html" title="A class that can be used to write values from (almost) any kind of widget or object.">QuWriter</a> as example, the two constructors are as follows:</p>
<blockquote class="doxtable">
<p >&zwj;<a class="el" href="classQuWriter.html" title="A class that can be used to write values from (almost) any kind of widget or object.">QuWriter(QObject *parent, Cumbia *cumbia, const CuControlsWriterFactoryI &amp;w_fac)</a>; </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;<a class="el" href="classQuWriter.html" title="A class that can be used to write values from (almost) any kind of widget or object.">QuWriter(QObject *w, CumbiaPool *cumbia_pool, const CuControlsFactoryPool &amp;fpool)</a>; </p>
</blockquote>
<p>The only difference can be seen in the first constructor, where we find a <a class="el" href="classCuControlsWriterFactoryI.html" title="cumbia-qtcontrols writer factory. Creates an instance of a CuControlWriterA implementation.">CuControlsWriterFactoryI</a> const reference, the analogy with the reader's <a class="el" href="classCuControlsReaderFactoryI.html" title="cumbia-qtcontrols reader factory. Creates an instance of a CuControlsReaderA implementation.">CuControlsReaderFactoryI</a> is clear.</p>
<h2>Targets</h2>
<p >A target in <em>cumbia</em> is the name (address) of a quantity that can be written, i.e. it's the <em>target</em> of an action.</p>
<p >Methods:</p>
<blockquote class="doxtable">
<p >&zwj;void setTarget(const QString&amp; target); </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;QString target() const; </p>
</blockquote>
<p>The name of the target depends on the engine employed, and identifies a connection endpoint, e.g. for Tango a device or server name plus the name of a command or attribute, and for Epics a PV. A couple of examples follow:</p>
<ul>
<li><em>test/device/1/double_scalar</em>: an example of Tango attribute; </li>
<li><em>b/power_supply/psb_s1.1-&gt;SetCurrent(10)</em>: calls the SetCurrent command to a Tango device with 10 as input argument </li>
<li><em>test/device/2/long_scalar(&amp;doubleSpinBox)</em> writes the value taken from a QDoubleSpinBox named "doubleSpinBox" into the double_scalar attribute of test/device/2 </li>
<li><em>$1/long_scalar(&amp;doubleSpinBox)</em> writes the value taken from a QDoubleSpinBox named "doubleSpinBox" into the double_scalar attribute of the device specified as <em>first</em> command line argument of the application. </li>
<li><em>control:ai1</em> is an example of <em>epics</em> target</li>
</ul>
<p>Independent of the syntax of the names, an expression can be used to provide one or more input arguments to the command. The input argument(s) can be:</p>
<ul>
<li>provided statically: <em>test/device/one-&gt;command(10,100)</em>; </li>
<li>taken from <em>another</em> editable widget: <em>a/b/c-&gt;command(&amp;pressureSpinBox)</em>. Here <em>pressureSpinBox</em> is the object name of a QDoubleSpinBox used to give a double value as input for the command <em>a/b/c-&gt;command</em></li>
</ul>
<p>In the second case, the editable widget providing the input must implement one of the following properties:</p>
<ul>
<li>text (example: a QLineEdit) </li>
<li>value (examples: QSpinBox, QDoubleSpinBox, <a class="el" href="classQuApplyNumeric.html" title="A widget to input a number and write it to a target linked to a control system engine.">QuApplyNumeric</a>, QProgressBar, ...) </li>
<li>currentText (example: QComboBox).</li>
</ul>
<p>Custom widget that provide input arguments for targets can be implemented, as long as they provide one of the three properties above mentioned. The properties listed above are evaluated by the <a class="el" href="classCuControlsUtils.html#aa5fd75956743c2d19eb56fbebb107685">CuControlsUtils::findInput</a> in that exact order.</p>
<p >Users of QTango should recognize the equivalent syntax. A relevant difference is that in <em>cumbia</em> you normally set only one target on a widget. The method is actually called <em>setTarget</em>, not <em>setTargets</em> as it was in QTango. Unlike QTango, it is enough for the widgets providing input arguments to have one of the three listed properties.</p>
<h1>The <em>qumbiaprojectwizard</em> utility, the <em>Qt designer</em> and the <em>cuuimake</em> tool</h1>
<p >The <em>qumbiaprojectwizard</em> application, the Qt designer and the <em>cuuimake</em> tool from qumbia-apps, make developing cumbia applications very easy. see the <a href="../../qumbia-tango-controls/html/md_src_tutorial_qumbiatango_widget.html">writing a qt widget that integrates with cumbia</a> tutorial for an example. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 17 2022 11:59:27 for cumbia-qtcontrols by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
