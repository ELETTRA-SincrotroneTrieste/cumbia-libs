<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-qtcontrols: CuAppStateManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cumbia-qtcontrols
   &#160;<span id="projectnumber">1.x</span>
   </div>
   <div id="projectbrief">Qt widgets on top of the cumbia C++ library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classCuAppStateManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CuAppStateManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class calls suspend and start on all children of a given root QObject according to the QGuiApplication state changes.  
 <a href="classCuAppStateManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cuappstatemanager_8h_source.html">cuappstatemanager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CuAppStateManager:</div>
<div class="dyncontent">
<div class="center"><img src="classCuAppStateManager__inherit__graph.png" border="0" usemap="#CuAppStateManager_inherit__map" alt="Inheritance graph"/></div>
<map name="CuAppStateManager_inherit__map" id="CuAppStateManager_inherit__map">
<area shape="rect"  title="This class calls suspend and start on all children of a given root QObject according to the QGuiAppli..." alt="" coords="5,80,148,107"/>
<area shape="rect"  title=" " alt="" coords="41,5,112,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a169e6336415a07cddd8c51e67bc53025"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuAppStateManager.html#a169e6336415a07cddd8c51e67bc53025">CuAppStateManager</a> (QGuiApplication *app, QObject *root)</td></tr>
<tr class="separator:a169e6336415a07cddd8c51e67bc53025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd9214a7cfd2393e1afa1963c5647deb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuAppStateManager.html#abd9214a7cfd2393e1afa1963c5647deb">addSuspendable</a> (QObject *suspendable)</td></tr>
<tr class="separator:abd9214a7cfd2393e1afa1963c5647deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6282f0ba37ae4d063ca9ee20ddf22499"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuAppStateManager.html#a6282f0ba37ae4d063ca9ee20ddf22499">removeSuspendable</a> (QObject *suspendable)</td></tr>
<tr class="separator:a6282f0ba37ae4d063ca9ee20ddf22499"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class calls suspend and start on all children of a given root QObject according to the QGuiApplication state changes. </p>
<p>This utility can be used when readers must be suspended when the application becomes inactive. This approach is fundamental when developing applications on mobile devices.</p>
<dl class="section user"><dt>Example: using CuAppStateManager in a qml based application for android</dt><dd></dd></dl>
<p>This is how main.cpp should look like in order to build an application which properly reacts to state changes</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QQmlApplicationEngine&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QQuickView&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QQmlContext&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cucontrolsfactorypool_8h.html">cucontrolsfactorypool.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cumbiapool__o_8h.html">cumbiapool_o.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cumbiapool.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cumbiawebsocket.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cuwsreader.h&gt;</span> <span class="comment">// for CuWSReaderFactory</span></div><div class="line"><span class="preprocessor">#include &lt;qmlappstatemanager.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cuthreadfactoryimpl.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="qthreadseventbridgefactory_8h.html">qthreadseventbridgefactory.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="examples_2button_2main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line">{</div><div class="line">    CumbiaPool *cu_pool = <span class="keyword">new</span> CumbiaPool();</div><div class="line">    <a class="code" href="classCuControlsFactoryPool.html">CuControlsFactoryPool</a> m_ctrl_factory_pool;</div><div class="line"></div><div class="line">    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);</div><div class="line"></div><div class="line">    QApplication app(argc, argv); <span class="comment">// before creating CumbiaWebSocket!</span></div><div class="line"></div><div class="line">    <span class="comment">// setup Cumbia pool and register cumbia implementations for tango and epics</span></div><div class="line">    CumbiaWebSocket* cuws = <span class="keyword">new</span> CumbiaWebSocket(<span class="stringliteral">&quot;ws://pwma-dev.elettra.eu:10080/updates&quot;</span>,</div><div class="line">                                                <span class="stringliteral">&quot;https://pwma-dev.elettra.eu:10443/v1/cs/&quot;</span>,</div><div class="line">                                                <span class="keyword">new</span> CuThreadFactoryImpl(), <span class="keyword">new</span> <a class="code" href="classQThreadsEventBridgeFactory.html">QThreadsEventBridgeFactory</a>());</div><div class="line">    std::vector&lt;std::string&gt; tango_proto_patterns;</div><div class="line">    tango_proto_patterns.push_back(<span class="stringliteral">&quot;tango://&quot;</span>);</div><div class="line">    cu_pool-&gt;registerCumbiaImpl(<span class="stringliteral">&quot;tango&quot;</span>, cuws);</div><div class="line">    m_ctrl_factory_pool.<a class="code" href="classCuControlsFactoryPool.html#a9c7dbaa9be372435e8199e330a4c5172">registerImpl</a>(<span class="stringliteral">&quot;tango&quot;</span>, CuWSReaderFactory());</div><div class="line"></div><div class="line">    m_ctrl_factory_pool.<a class="code" href="classCuControlsFactoryPool.html#a6c7da9b8e3deaed21beed2935c2ad084">setSrcPatterns</a>(<span class="stringliteral">&quot;tango&quot;</span>,tango_proto_patterns);</div><div class="line">    cu_pool-&gt;setSrcPatterns(<span class="stringliteral">&quot;tango&quot;</span>, tango_proto_patterns);</div><div class="line"></div><div class="line">    <a class="code" href="classCumbiaPool__O.html">CumbiaPool_O</a> cumbia_fac_qobj;</div><div class="line"></div><div class="line">    cumbia_fac_qobj.<a class="code" href="classCumbiaPool__O.html#adea20aa40b78d50fa7db78b1eb02cd4c">init</a>(cu_pool, m_ctrl_factory_pool);</div><div class="line"></div><div class="line">    QQuickView *view = <span class="keyword">new</span> QQuickView;</div><div class="line">    view-&gt;resize(800, 400);</div><div class="line">    view-&gt;setResizeMode(QQuickView::SizeRootObjectToView);</div><div class="line">    view-&gt;engine()-&gt;rootContext()-&gt;setContextProperty(<span class="stringliteral">&quot;cumbia_poo_o&quot;</span>, &amp;cumbia_fac_qobj);</div><div class="line">    view-&gt;setSource(QUrl(<span class="stringliteral">&quot;qrc:/main.qml&quot;</span>));</div><div class="line">    view-&gt;show();</div><div class="line"></div><div class="line">    <span class="comment">// manage application state changes</span></div><div class="line">    <a class="code" href="classCuAppStateManager.html">CuAppStateManager</a> appstman(&amp;app, view);</div><div class="line">    <span class="comment">// close websocket when the application is inactive, reopen it when it&#39;s active again</span></div><div class="line">    appstman.addSuspendable(cuws-&gt;websocketClient());</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> ret = app.exec();</div><div class="line">    <span class="keyword">delete</span> view;</div><div class="line">    <span class="keyword">delete</span> cuws;</div><div class="line">    <span class="keyword">delete</span> cu_pool;</div><div class="line">    <span class="keywordflow">return</span> ret;</div><div class="line">}</div></div><!-- fragment --><p>When an application changes its state, all children of the specified root object (QQuickView in the example) are asked to suspend or start, according to the new state. It is necessary that the children are QObject and implement the <em>start and suspend</em> methods.</p>
<p>Additional objects that are not children of the given root can be added through the addSuspendable method. They must be QObject and implement the <em>start and suspend</em> methods.</p>
<dl class="section user"><dt>Note</dt><dd>If <a class="el" href="classCuAppStateManager.html" title="This class calls suspend and start on all children of a given root QObject according to the QGuiAppli...">CuAppStateManager</a> is used as shown in the example (passing the root of the view), it is not necessary to write additional code in the <em>qml</em> file to suspend and restart the (readers) backends every time the application state changes. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a169e6336415a07cddd8c51e67bc53025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a169e6336415a07cddd8c51e67bc53025">&#9670;&nbsp;</a></span>CuAppStateManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CuAppStateManager::CuAppStateManager </td>
          <td>(</td>
          <td class="paramtype">QGuiApplication *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QObject *&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abd9214a7cfd2393e1afa1963c5647deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd9214a7cfd2393e1afa1963c5647deb">&#9670;&nbsp;</a></span>addSuspendable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CuAppStateManager::addSuspendable </td>
          <td>(</td>
          <td class="paramtype">QObject *&#160;</td>
          <td class="paramname"><em>suspendable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="examples_2qmlandroidpwma_2main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a6282f0ba37ae4d063ca9ee20ddf22499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6282f0ba37ae4d063ca9ee20ddf22499">&#9670;&nbsp;</a></span>removeSuspendable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CuAppStateManager::removeSuspendable </td>
          <td>(</td>
          <td class="paramtype">QObject *&#160;</td>
          <td class="paramname"><em>suspendable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cuappstatemanager_8h_source.html">cuappstatemanager.h</a></li>
<li><a class="el" href="cuappstatemanager_8cpp.html">cuappstatemanager.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Dec 3 2019 16:26:26 for cumbia-qtcontrols by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
