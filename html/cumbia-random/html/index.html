<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-random: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cumbia-random
   &#160;<span id="projectnumber">1.x</span>
   </div>
   <div id="projectbrief">Generate numbers or arrays to use with cumbia, randomly or from JavaScript files</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">cumbia-random Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p>The <a class="el" href="classCumbiaRandom.html">CumbiaRandom</a> module generates data randomly or from a specified JavaScript file. Data can be used to test higher level applications in terms of usability, performance and behaviour in case of errors.</p>
<p>The module can be used and introduced into your application as any other <em>engine</em>. It can be registered with CumbiaPool/CuControlsFactoryPool as in usual <em>multi engine</em> projects, and the concept of <em>source</em> is equivalent. The module is "*read only*" (only sources, no <em>targets</em>), and any <em>cumbia-qtcontrols</em> widget can be associated with a <em>cumbia-random source</em>.</p>
<p>The difference is that there is no connection to any control system.</p>
<h1><a class="anchor" id="features"></a>
Features</h1>
<p>The sources supplied to the module determine how data is generated in terms of size, bounds and update period. Moreover, names can be used to determine thread grouping in case of multiple readers.</p>
<h2><a class="anchor" id="examples"></a>
Examples</h2>
<p>In the examples below, we use the <em>cumbia read</em> command line client.</p>
<h3><a class="anchor" id="read_scalar"></a>
Read a randomly generated scalar value</h3>
<div class="fragment"><div class="line">cumbia read random:<span class="comment">//one/random/number/1/0/100/one_r </span></div>
</div><!-- fragment --><p>The output will be:</p>
<div class="fragment"><div class="line">* one_r: [14:02:45+0.648788]  [double] 59.72 </div>
</div><!-- fragment --><p>The source in the example is made up of several sections separated by a '/':</p><ul>
<li>random:// associates what follows to the <em>cumbia-random</em> module (through the CumbiaPool and CuControlsFactoryPool)</li>
<li>one/random/number an arbitrary name that is given to the random source. Everything that precedes the '/'-separated numeric section is interpreted as the source name.</li>
<li>first number: the size of the generated result</li>
<li>second number: the minimum value that can be generated</li>
<li>third number: the maximum value</li>
<li><em>one_r</em> a <em>label</em> that can be associated to the source name (optional). If present, it is displayed in the output at the beginning of the line</li>
</ul>
<h3><a class="anchor" id="read_array"></a>
Read a randomly generated vector of 3 values between -100 and 100</h3>
<div class="fragment"><div class="line">cumbia read random:<span class="comment">//a/random/array/3/-100/100/array_3 </span></div>
</div><!-- fragment --><p> The output will be: </p><div class="fragment"><div class="line">* array_3: [14:37:26+0.249328] [double,3] { 61.62,-35.80,-35.02 } </div>
</div><!-- fragment --><h3><a class="anchor" id="monitor_array"></a>
Monitor a randomly generated vector of 3 values between -10 and +10 with a period of one second</h3>
<div class="fragment"><div class="line">cumbia monitor random:<span class="comment">//one/random/array/3/-10/10/monitor_a_3 </span></div>
</div><!-- fragment --><p> The output will be: </p><div class="fragment"><div class="line">* monitor started: press any key to exit</div>
<div class="line">  monitor_a_3: [14:39:16+0.627573] [double,3] { 8.11,3.82,-4.99 }</div>
<div class="line">  monitor_a_3: [14:39:16+0.627634] [double,3] { 0.53,6.21,-8.98 }</div>
<div class="line">  monitor_a_3: [14:39:17+0.627987] [double,3] { 1.39,-5.77,-6.22 }</div>
<div class="line">  monitor_a_3: [14:39:18+0.628198] [double,3] { -6.17,-8.67,-9.01 }</div>
<div class="line">  monitor_a_3: [14:39:19+0.628415] [double,3] { 1.48,7.36,9.45 }</div>
<div class="line">  [...]</div>
</div><!-- fragment --><p>A monitor is stopped whenever a key is pressed. Avoid <em>CTRL-C</em> for proper termination.</p>
<h3><a class="anchor" id="monitor_3_arrays"></a>
Monitor three randomly generated vectors of 3 values each, with a period of one second</h3>
<div class="fragment"><div class="line">cumbia monitor random:<span class="comment">//a/random/array/3/-10/10/a_3  random://b/random/array/3/-12/12/b_3</span></div>
<div class="line">    random:<span class="comment">//c/random/array/3/-100/100/c_3  </span></div>
</div><!-- fragment --><p> The output will be: </p><div class="fragment"><div class="line">monitor started: press any key to exit</div>
<div class="line">a_3: [14:42:49+0.430095] [double,3] { 7.75,-1.79,4.73 }</div>
<div class="line">a_3: [14:42:49+0.430147] [double,3] { -2.53,-2.72,1.63 }</div>
<div class="line">b_3: [14:42:49+0.431249] [double,3] { 8.37,10.42,-9.41 }</div>
<div class="line">b_3: [14:42:49+0.431287] [double,3] { 9.46,4.48,5.46 }</div>
<div class="line">c_3: [14:42:49+0.431744] [double,3] { -16.46,-64.88,-15.70 }</div>
<div class="line">c_3: [14:42:49+0.431785] [double,3] { 68.69,1.35,20.00 }</div>
<div class="line">a_3: [14:42:50+0.430501] [double,3] { -5.11,4.62,-2.32 }</div>
<div class="line">b_3: [14:42:50+0.43159] [double,3] { 11.27,6.16,0.61 }</div>
<div class="line">c_3: [14:42:50+0.432018] [double,3] { -52.93,19.59,64.50 }</div>
<div class="line">a_3: [14:42:51+0.430715] [double,3] { -1.04,1.17,2.77 }</div>
<div class="line">b_3: [14:42:51+0.431767] [double,3] { 2.43,8.20,6.89 }</div>
<div class="line">c_3: [14:42:51+0.432161] [double,3] { -59.39,-99.55,67.54 }</div>
</div><!-- fragment --><p>Now take the last example and fetch some extra information, by adding &ndash;l=medium to the command line. The output will be more detailed:</p>
<div class="fragment"><div class="line">[...]</div>
<div class="line">  a_3: -10.00 &lt; [14:45:32+0.47847] [double,3] { -5.78,-0.14,-5.87 } [random:<span class="comment">//a/random/array/3/-10/10/a_3] &lt; 10.00 [in 30us]</span></div>
<div class="line">  b_3: -12.00 &lt; [14:45:32+0.478849] [double,3] { -8.28,-1.76,-8.73 } [random:<span class="comment">//b/random/array/3/-12/12/b_3] &lt; 12.00 [in 19us]</span></div>
<div class="line">  c_3: -100.00 &lt; [14:45:32+0.479327] [double,3] { 89.96,-66.21,-37.81 } [random:<span class="comment">//c/random/array/3/-100/100/c_3] &lt; 100.00 [in 26us]</span></div>
<div class="line">  [...] </div>
</div><!-- fragment --><p>The output encloses the read value between upper and lower bounds, shows the full source name and the execution time.</p>
<h3><a class="anchor" id="thread_grouping"></a>
Thread grouping</h3>
<p>The <em>cumbia-random</em> module takes the first section of the source string delimited by '/' to determine how to group number generator threads together. Add the &ndash;l=high option to get even more detailed information while reading:</p>
<div class="fragment"><div class="line">cumbia read random:<span class="comment">//th1/scalar/1/-10.0/10.2/r1  random://th2/array/2/0.0/10.0/r2  random://th1/array/3/-10.0/10.0/r3</span></div>
<div class="line">       --l=high</div>
</div><!-- fragment --><p>Output: </p><div class="fragment"><div class="line">r1: [th1] -10.00 &lt; [14:50:56+0.0891559]  [double] 10.10 [random:<span class="comment">//th1/scalar/1/-10.0/10.2/r1] &lt; 10.20 [in 50us]</span></div>
<div class="line">r2: [th2] 0.00 &lt; [14:50:56+0.0895171] [double,2] { 5.05,7.84 } [random:<span class="comment">//th2/array/2/0.0/10.0/r2] &lt; 10.00 [in 39us]</span></div>
<div class="line">r3: [th1] -10.00 &lt; [14:50:56+0.0900221] [double,3] { 6.04,-4.54,8.10 } [random:<span class="comment">//th1/array/3/-10.0/10.0/r3] &lt; 10.00 [in 25us]</span></div>
</div><!-- fragment --><p>After the labels, r1, r2, r3, <em>thread information</em> is shown between square brackets. As you can see, the <em>th1</em> and <em>th2</em> sections in the source names have been used to execute the three readings in two threads grouped by name.</p>
<h3><a class="anchor" id="js_gen"></a>
JavaScript generated data</h3>
<p>A <em>cumbia-random</em> source can specify a JavaScript file (name ending in *.js) as data provider. The <em>pattern</em> for the source must be:</p>
<div class="fragment"><div class="line">random:<span class="comment">//anything/you/want/file://path/to/file.js/SIZE/MIN/MAX[/PERIOD]/label</span></div>
</div><!-- fragment --><p>file.js will be passed the four arguments given in the source name (period is optional, default is 1 second) plus two additional parameters: the number of calls made to the function up to that moment and the value from the last call.</p>
<p>For example: </p><div class="fragment"><div class="line">cumbia monitor  random:<span class="comment">//file://js_functions/sin.js/100/-10/10/sin_f</span></div>
</div><!-- fragment --><p> will produce the following output</p>
<div class="fragment"><div class="line">monitor started: press any key to exit</div>
<div class="line">sin_f: [15:03:20+0.105853] [double,100] { -0.00,-2.19,-4.17,-5.73,-6.74,-7.09,-6.74,-5.73,-4.17,-2.19,-0.00,2.19,4.17,5.73,6.74,7.09,6.74,5.73,4.17,2.19,0.00,-2.19,-4.17,-5.73,-6.774,-5.73,-4.17,-2.19,-0.00,2.19,4.17,5.73,6.74,7.09,6.74,5.73,4.17,2.19,0.00,-2.19,-4.17,-5.73,-6.74,-7.09,-6.74,-5.73,-4.17,-2.19,-0.00,2.19,4.17,5.73,6.74,7.09,6.74,5.73,4.17,2.19,04.17,-5.73,-6.74,-7.09,-6.74,-5.73,-4.17,-2.19,-0.00,2.19,4.17,5.73,6.74,7.09,6.74,5.73,4.17,2.19,0.00,-2.19,-4.17,-5.73,-6.74,-7.09,-6.74,-5.73,-4.17,-2.19,-0.00,2.19,4.17,5.73,6.74,.73,4.17,2.19 }</div>
<div class="line">sin_f: [15:03:20+0.105985] [double,100] { -0.00,-1.89,-3.59,-4.94,-5.81,-6.11,-5.81,-4.94,-3.59,-1.89,-0.00,1.89,3.59,4.94,5.81,6.11,5.81,4.94,3.59,1.89,0.00,-1.89,-3.59,-4.94,-5.881,-4.94,-3.59,-1.89,-0.00,1.89,3.59,4.94,5.81,6.11,5.81,4.94,3.59,1.89,0.00,-1.89,-3.59,-4.94,-5.81,-6.11,-5.81,-4.94,-3.59,-1.89,-0.00,1.89,3.59,4.94,5.81,6.11,5.81,4.94,3.59,1.89,03.59,-4.94,-5.81,-6.11,-5.81,-4.94,-3.59,-1.89,-0.00,1.89,3.59,4.94,5.81,6.11,5.81,4.94,3.59,1.89,0.00,-1.89,-3.59,-4.94,-5.81,-6.11,-5.81,-4.94,-3.59,-1.89,-0.00,1.89,3.59,4.94,5.81,.94,3.59,1.89 }</div>
</div><!-- fragment --><p>To see a plot of the sin function, you would rather issue the following command:</p>
<div class="fragment"><div class="line">cumbia client  random:<span class="comment">//file://js_functions/sin.js/100/-10/10/sin_f</span></div>
</div><!-- fragment --> <div class="image">
<img src="cumbia_client_sin.png" alt=""/>
<div class="caption">
cumbia client with a sin function generated by a JavaScript function in a js file</div></div>
 <p>In the example, the working directory contains a file named <em>sin.js</em> under the <em>js_functions</em> folder. An absolute path can be specified as well</p>
<div class="fragment"><div class="line">cumbia monitor random:<span class="comment">//file:///home/giacomo/devel/utils/git/cppqtclients/cumbia-libs/qumbia-apps/qumbia-reader/js_functions/sin.js/100/0/1</span></div>
</div><!-- fragment --><h2><a class="anchor" id="further_reading"></a>
Further reading</h2>
<p>The <a href="../../qumbia-reader/html/index.html">cumbia read</a> command line client with bash auto completion functionality. The <a href="../../qumbia-client/html/index.html">cumbia client</a> Qt graphical client with bash auto completion functionality.</p>
<h1><a class="anchor" id="include_module"></a>
Including the module in a cumbia application</h1>
<p>Just a few lines of code are necessary to integrate the <em>cumbia-random</em> module in your graphical application. Presently, you will be able to take advantage of the testing features provided by the module.</p>
<h2><a class="anchor" id="pkg_config"></a>
Using pkg-config file</h2>
<p>A <em>cumbia-random.pc</em> <em>pkg-config</em> file is distributed under the <em>INSTALL_ROOT/lib/pkgconfig</em> directory. It can be used to include <em>cumbia-random</em> in your project.</p>
<h2><a class="anchor" id="qt_pro"></a>
Through the Qt pro file</h2>
<p>For Qt applications, adding the following lines to the Qt <em>project file</em> (.pro) is enough:</p>
<div class="fragment"><div class="line">exists($${INSTALL_ROOT}/include/cumbia-random/cumbia-random.pri) {</div>
<div class="line">  include($${INSTALL_ROOT}/include/cumbia-random/cumbia-random.pri)</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="cpp_file"></a>
Modify the main class &lt;em&gt;cpp&lt;/em&gt; file</h2>
<p>CumbiaPool and CuControlsFactoryPool objects are necessary when your application is required to support multiple engines. If the project is generated with the <em>cumbia new project</em> tool and the <em>multiple engine support</em> option is chosen, then you only need to add the following lines to the main class <em>cpp file</em>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef CUMBIA_RANDOM_VERSION</span></div>
<div class="line"><span class="preprocessor">   #include &lt;<a class="code" href="cumbiarandom_8h.html">cumbiarandom.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">   #include &lt;<a class="code" href="cumbiarndworld_8h.html">cumbiarndworld.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"> #ifdef CUMBIA_RANDOM_VERSION</span></div>
<div class="line">    <a class="code" href="classCumbiaRandom.html">CumbiaRandom</a> *cura = <span class="keyword">new</span> <a class="code" href="classCumbiaRandom.html">CumbiaRandom</a>(<span class="keyword">new</span> CuThreadFactoryImpl(), <span class="keyword">new</span> QThreadsEventBridgeFactory());</div>
<div class="line">    <a class="code" href="classCumbiaRNDWorld.html">CumbiaRNDWorld</a> rndw;</div>
<div class="line">    cu_pool-&gt;registerCumbiaImpl(<span class="stringliteral">&quot;random&quot;</span>, cura);</div>
<div class="line">    m_ctrl_factory_pool.registerImpl(<span class="stringliteral">&quot;random&quot;</span>, <a class="code" href="classCuRNDReaderFactory.html">CuRNDReaderFactory</a>());</div>
<div class="line">    m_ctrl_factory_pool.<a class="code" href="classCumbiaRNDWorld.html#a46f74c8ce3ac7e4acde2a4e28fd4aa5b">setSrcPatterns</a>(<span class="stringliteral">&quot;random&quot;</span>, rndw.<a class="code" href="classCumbiaRNDWorld.html#ad8acd70d172fe4b9bcfde3c79d90a4c5">srcPatterns</a>());</div>
<div class="line">    cu_pool-&gt;setSrcPatterns(<span class="stringliteral">&quot;random&quot;</span>, rndw.<a class="code" href="classCumbiaRNDWorld.html#ad8acd70d172fe4b9bcfde3c79d90a4c5">srcPatterns</a>());</div>
<div class="line">    cura-&gt;getServiceProvider()-&gt;registerService(CuServices::Log, <span class="keyword">new</span> CuLog(&amp;m_log_impl));</div>
<div class="line"><span class="preprocessor"> #endif</span></div>
</div><!-- fragment --><p>in complete analogy with any other multi engine project, that, for instance, requires support for <em>Tango</em> and <em>EPICS</em>.</p>
<dl class="section user"><dt>Notes</dt><dd><ul>
<li><em>cu_pool</em> is a pointer to a CumbiaPool object</li>
<li><em>m_ctrl_factory_pool</em> is a private attribute of the main class, type CuControlsFactoryPool</li>
<li><em>m_log_impl</em> is a log implementation</li>
<li><em><a class="el" href="classCuRNDReaderFactory.html">CuRNDReaderFactory</a></em> is a factory that instantiates random readers</li>
<li>the <em>setSrcPatterns</em> methods register sources starting with the <em>random://</em> prefix with the <em>cumbia-random</em> module.</li>
</ul>
</dd></dl>
<p>To comply with the given implementation, the main class will have these attributes </p><div class="fragment"><div class="line"><span class="keyword">private</span>:</div>
<div class="line">   CumbiaPool *cu_pool;</div>
<div class="line">   QuLogImpl m_log_impl;</div>
<div class="line">   CuLog *m_log;</div>
<div class="line">   CuControlsFactoryPool m_ctrl_factory_pool;</div>
</div><!-- fragment --><p>The <a href="../../qumbia-reader/html/index.html">cumbia read</a> and the <a href="../../qumbia-client/html/index.html">cumbia client</a> apps are examples of multi-engine integration including <em>cumbia-random</em>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="aclassCuRNDReaderFactory_html"><div class="ttname"><a href="classCuRNDReaderFactory.html">CuRNDReaderFactory</a></div><div class="ttdef"><b>Definition:</b> curndreader.h:12</div></div>
<div class="ttc" id="aclassCumbiaRandom_html"><div class="ttname"><a href="classCumbiaRandom.html">CumbiaRandom</a></div><div class="ttdef"><b>Definition:</b> cumbiarandom.h:235</div></div>
<div class="ttc" id="aclassCumbiaRNDWorld_html_a46f74c8ce3ac7e4acde2a4e28fd4aa5b"><div class="ttname"><a href="classCumbiaRNDWorld.html#a46f74c8ce3ac7e4acde2a4e28fd4aa5b">CumbiaRNDWorld::setSrcPatterns</a></div><div class="ttdeci">void setSrcPatterns(const std::vector&lt; std::string &gt; &amp;pat_regex)</div><div class="ttdef"><b>Definition:</b> cumbiarndworld.cpp:8</div></div>
<div class="ttc" id="aclassCumbiaRNDWorld_html"><div class="ttname"><a href="classCumbiaRNDWorld.html">CumbiaRNDWorld</a></div><div class="ttdef"><b>Definition:</b> cumbiarndworld.h:9</div></div>
<div class="ttc" id="acumbiarndworld_8h_html"><div class="ttname"><a href="cumbiarndworld_8h.html">cumbiarndworld.h</a></div></div>
<div class="ttc" id="aclassCumbiaRNDWorld_html_ad8acd70d172fe4b9bcfde3c79d90a4c5"><div class="ttname"><a href="classCumbiaRNDWorld.html#ad8acd70d172fe4b9bcfde3c79d90a4c5">CumbiaRNDWorld::srcPatterns</a></div><div class="ttdeci">std::vector&lt; std::string &gt; srcPatterns() const</div><div class="ttdef"><b>Definition:</b> cumbiarndworld.cpp:13</div></div>
<div class="ttc" id="acumbiarandom_8h_html"><div class="ttname"><a href="cumbiarandom_8h.html">cumbiarandom.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 5 2020 15:52:52 for cumbia-random by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
