<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-http: Cumbia &lt;em&gt;http&lt;/em&gt; module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cumbia-http<span id="projectnumber">&#160;1.x</span>
   </div>
   <div id="projectbrief">Qt widgets on top of the cumbia C++ library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Cumbia <em>http</em> module </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The <em>cumbia http</em> module provides an interface to send and receive data through <em>http[s]</em> and <em>Server Sent Events</em> (SSE). The library relies on the <em>canone3</em> server (caserver):</p>
<ul>
<li>The <a href="https://gitlab.com/PWMA/">PWMA</a> project</li>
</ul>
<p >The <em>cumbia http</em> module has been developed in order to build applications for <b>desktop, mobile devices and web applications</b>, enabled to interact with the Tango and EPICS control systems through the aforementioned service.</p>
<p >Desktop applications written with cumbia will run transparently either relying on a native engine or the <em>http</em> module. They do not require engine specific code, nor they require rebuilding. Additionally, the sources specified as command line arguments need not be changed across different engines. Engine independent apps are built using the CuModuleLoader class available since version 1.2.0:</p>
<p >qmake project.pro file: </p><div class="fragment"><div class="line">isEmpty(CUMBIA_ROOT) {</div>
<div class="line">  CUMBIA_ROOT=/usr/local/cumbia-libs</div>
<div class="line">}</div>
<div class="line">include($${CUMBIA_ROOT}/include/quapps/quapps.pri)</div>
</div><!-- fragment --><p >cpp: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;quapps.h&gt;</span></div>
<div class="line"> </div>
<div class="line">MyQtApp::MyQtApp(CumbiaPool *cumbia_pool, QWidget *parent) :</div>
<div class="line">    QWidget(parent),</div>
<div class="line">    cu_pool(cumbia_pool),</div>
<div class="line">    ui(new <a class="code hl_namespaceRef" href="../../qumbia-epics-controls/html/namespaceUi.html">Ui</a>::HttpTest) {</div>
<div class="line">    <span class="comment">// load available module</span></div>
<div class="line">    CuModuleLoader mloader(cumbia_pool, &amp;m_ctrl_factory_pool, &amp;m_log_impl);</div>
<div class="line">    ui-&gt;setupUi(<span class="keyword">this</span>, cumbia_pool, m_ctrl_factory_pool);</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceUi_html"><div class="ttname"><a href="../../qumbia-epics-controls/html/namespaceUi.html">Ui</a></div></div>
</div><!-- fragment --><p >Sources specified on the command line need not be changed, but the http URL and the channel where the <em>http</em> application receives server sent events must be given, unless the utility</p>
<div class="fragment"><div class="line">cumbia  apps module-<span class="keywordflow">default</span> [set]</div>
</div><!-- fragment --><p >is used to set up an environment where <em>http</em> module is used by default. This is useful on workstations where <em>native</em> engines are unavailable.</p>
<p ><a class="el" href="classCumbiaHttp.html">CumbiaHttp</a> is a CuHTTPActionListener in order to be notified when an action is finished, so that it can be unregistered and deleted.</p>
<h1><a class="anchor" id="tech_notes"></a>
Technical notes</h1>
<p >Either read or write operation will call CumbiaHttp::addAction with the complete name of the source, a pointer to a CuDataListener and a const reference to either a <a class="el" href="classCuHTTPActionReaderFactory.html">CuHTTPActionReaderFactory</a> or a <a class="el" href="classCuHTTPActionWriterFactory.html">CuHTTPActionWriterFactory</a>, respectively. See <a class="el" href="classCuHttpControlsReader.html">CuHttpControlsReader</a>. The factories may contain options. A relevant one for a reader is the <em>single-shot</em>, that reads a quantity once.</p>
<p >CumbiaHttp::addAction enqueues the request so that multiple requests are gathered together and sent in bundles, saving the number of http requests to the server. <a class="el" href="classCuHttpSrcMan.html" title="Http source queue and data manager.">CuHttpSrcMan</a> is where source subscriptions are enqueued and a timer quickly dequeues them so that they are packed in a small number of http requests. When a bundle is ready, <a class="el" href="classCumbiaHttp.html#ab912d039ba154e2215a4e2f201319972">CumbiaHttp::onSrcBundleReqReady</a> starts an http request to the server, with the multiple subscription requests represented in Json format.</p>
<p >Whatever the operation, single read, monitor, write... <em>a synchronous reply is always expected</em>. In the <em>monitor</em> case, subsequent updates are received through an SSE channel. The server will recollect results for each request and pack them in a reply which will contain either a value (a reading, configuration properties) or an error. In the <em>monitor</em> example, a request will contain a <em>subscribe</em> option. The <em>synchronous</em> reply will provide the first read value (or configuration) <em>or</em> an error condition. This implies that if one or more amongst the <em>n</em> sources takes time before being available, all sources in the bundle will be delivered late. Updates are distributed across the SSE channel. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 17 2022 12:12:39 for cumbia-http by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
