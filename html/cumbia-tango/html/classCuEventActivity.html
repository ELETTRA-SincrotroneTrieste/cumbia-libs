<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-tango: CuEventActivity Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cumbia-tango
   &#160;<span id="projectnumber">1.x</span>
   </div>
   <div id="projectbrief">C++ multi threaded library based on cumbia and the Tango control system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classCuEventActivity-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CuEventActivity Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>an activity to subscribe and receive events from <a class="el" href="namespaceTango.html">Tango</a>. Implements CuActivity and Tango::Callback interfaces  
 <a href="classCuEventActivity.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cueventactivity_8h_source.html">cueventactivity.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CuEventActivity:</div>
<div class="dyncontent">
<div class="center"><img src="classCuEventActivity__inherit__graph.png" border="0" usemap="#CuEventActivity_inherit__map" alt="Inheritance graph"/></div>
<map name="CuEventActivity_inherit__map" id="CuEventActivity_inherit__map">
<area shape="rect"  title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int..." alt="" coords="50,80,166,107"/>
<area shape="rect"  title=" " alt="" coords="5,5,88,32"/>
<area shape="rect"  title=" " alt="" coords="112,5,229,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a1dc111181e0c5b18e7d7053c97c6dffa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a1dc111181e0c5b18e7d7053c97c6dffa">Type</a> { <a class="el" href="classCuEventActivity.html#a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692">CuEventActivityType</a> = CuActivity::User + 2
 }</td></tr>
<tr class="separator:a1dc111181e0c5b18e7d7053c97c6dffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4c6823275cd839e813b378591b207d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#ab4c6823275cd839e813b378591b207d7">CuEventActivity</a> (const CuData &amp;token, <a class="el" href="classCuDeviceFactoryService.html">CuDeviceFactoryService</a> *df)</td></tr>
<tr class="memdesc:ab4c6823275cd839e813b378591b207d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">the class constructor that configures the activity event flags  <a href="#ab4c6823275cd839e813b378591b207d7">More...</a><br /></td></tr>
<tr class="separator:ab4c6823275cd839e813b378591b207d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa70c452d4c66cdcd58362e3253fef197"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#aa70c452d4c66cdcd58362e3253fef197">~CuEventActivity</a> ()</td></tr>
<tr class="memdesc:aa70c452d4c66cdcd58362e3253fef197"><td class="mdescLeft">&#160;</td><td class="mdescRight">the class destructor  <a href="#aa70c452d4c66cdcd58362e3253fef197">More...</a><br /></td></tr>
<tr class="separator:aa70c452d4c66cdcd58362e3253fef197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74957e066b57442baaa8302982a8a5c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a74957e066b57442baaa8302982a8a5c3">getType</a> () const</td></tr>
<tr class="memdesc:a74957e066b57442baaa8302982a8a5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the CuEventActivityType value  <a href="#a74957e066b57442baaa8302982a8a5c3">More...</a><br /></td></tr>
<tr class="separator:a74957e066b57442baaa8302982a8a5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a240eac895da7a029f62c471dcee4c40d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a240eac895da7a029f62c471dcee4c40d">event</a> (CuActivityEvent *e)</td></tr>
<tr class="memdesc:a240eac895da7a029f62c471dcee4c40d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive events <em>from the main thread to the CuActivity thread</em>.  <a href="#a240eac895da7a029f62c471dcee4c40d">More...</a><br /></td></tr>
<tr class="separator:a240eac895da7a029f62c471dcee4c40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8ea11150700078091feae1978c0117"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a1d8ea11150700078091feae1978c0117">matches</a> (const CuData &amp;token) const</td></tr>
<tr class="memdesc:a1d8ea11150700078091feae1978c0117"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true if the passed token's <em>src</em> and <em>activity</em> values matche this activity token's <em>src</em> and <em>activity</em> values.  <a href="#a1d8ea11150700078091feae1978c0117">More...</a><br /></td></tr>
<tr class="separator:a1d8ea11150700078091feae1978c0117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7229cfb59440313eb7786dd751c22a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#ae7229cfb59440313eb7786dd751c22a3">repeat</a> () const</td></tr>
<tr class="memdesc:ae7229cfb59440313eb7786dd751c22a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns 0. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a>'s execute is called only once.  <a href="#ae7229cfb59440313eb7786dd751c22a3">More...</a><br /></td></tr>
<tr class="separator:ae7229cfb59440313eb7786dd751c22a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a8fe09cefefbe4446cf7a0cb0cdec386e">init</a> ()</td></tr>
<tr class="memdesc:a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::init hook  <a href="#a8fe09cefefbe4446cf7a0cb0cdec386e">More...</a><br /></td></tr>
<tr class="separator:a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac712e113c8eed3bbf7db935eada457"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a8ac712e113c8eed3bbf7db935eada457">execute</a> ()</td></tr>
<tr class="memdesc:a8ac712e113c8eed3bbf7db935eada457"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::execute hook  <a href="#a8ac712e113c8eed3bbf7db935eada457">More...</a><br /></td></tr>
<tr class="separator:a8ac712e113c8eed3bbf7db935eada457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85edf01781777eb1dee022bdc2c8d162"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a85edf01781777eb1dee022bdc2c8d162">onExit</a> ()</td></tr>
<tr class="memdesc:a85edf01781777eb1dee022bdc2c8d162"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::execute hook  <a href="#a85edf01781777eb1dee022bdc2c8d162">More...</a><br /></td></tr>
<tr class="separator:a85edf01781777eb1dee022bdc2c8d162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53084b7cc8f9366d09d84e7f55f20dc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCuEventActivity.html#a53084b7cc8f9366d09d84e7f55f20dc6">push_event</a> (Tango::EventData *)</td></tr>
<tr class="memdesc:a53084b7cc8f9366d09d84e7f55f20dc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">receive events from <a class="el" href="namespaceTango.html">Tango</a>, extract data and post the result on the main thread through publishResult  <a href="#a53084b7cc8f9366d09d84e7f55f20dc6">More...</a><br /></td></tr>
<tr class="separator:a53084b7cc8f9366d09d84e7f55f20dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>an activity to subscribe and receive events from <a class="el" href="namespaceTango.html">Tango</a>. Implements CuActivity and Tango::Callback interfaces </p>
<p>Implementing CuActivity, the work is done in the background by the three methods</p>
<ul>
<li>init </li>
<li>execute </li>
<li>onExit</li>
</ul>
<p>They are called from a separate thread. In cumbia-tango, threads are grouped by device. As an implementor of Tango::Callback, events are received through the push_event callback</p>
<p>Apart from the three execution hooks listed above, some other methods have been written to comply with the CuActivityInterface:</p>
<ul>
<li>getType, returning CuEventActivityType </li>
<li>event, to receive CuActivityEvent events </li>
<li>matches, that returns true if the input token represents an activity like this </li>
<li>repeat, that in this case always returns false</li>
</ul>
<dl class="section user"><dt>note</dt><dd>To solve a known <a class="el" href="namespaceTango.html">Tango</a> issue that prevents events from working if the client application subscribes to sources across different devices, an instance of omni_thread::ensure_self is kept alive as long as the <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> lives. </dd></dl>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a1dc111181e0c5b18e7d7053c97c6dffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc111181e0c5b18e7d7053c97c6dffa">&#9670;&nbsp;</a></span>Type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classCuEventActivity.html#a1dc111181e0c5b18e7d7053c97c6dffa">CuEventActivity::Type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692"></a>CuEventActivityType&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab4c6823275cd839e813b378591b207d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4c6823275cd839e813b378591b207d7">&#9670;&nbsp;</a></span>CuEventActivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CuEventActivity::CuEventActivity </td>
          <td>(</td>
          <td class="paramtype">const CuData &amp;&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCuDeviceFactoryService.html">CuDeviceFactoryService</a> *&#160;</td>
          <td class="paramname"><em>df</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the class constructor that configures the activity event flags </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>a CuData that will identify this activity </td></tr>
    <tr><td class="paramname">df</td><td>a pointer to a <a class="el" href="classCuDeviceFactoryService.html" title="implements CuServiceI interface and provides a service to create and store Tango devices (wrapped by ...">CuDeviceFactoryService</a> that is used by init and onExit to create/obtain and later get rid of a <a class="el" href="namespaceTango.html">Tango</a> device, respectively.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Default activity flags</dt><dd>The default activity flags set by the <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> constructor are</dd></dl>
<ul>
<li>CuActivity::CuAUnregisterAfterExec: <em>false</em>: the activity is not unregistered after exec. Instead, it keeps living within an event loop that delivers <a class="el" href="namespaceTango.html">Tango</a> events over time </li>
<li>CuActivity::CuADeleteOnExit: <em>true</em> lets the activity be deleted after onExit </li>
</ul>

</div>
</div>
<a id="aa70c452d4c66cdcd58362e3253fef197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa70c452d4c66cdcd58362e3253fef197">&#9670;&nbsp;</a></span>~CuEventActivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CuEventActivity::~CuEventActivity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the class destructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a240eac895da7a029f62c471dcee4c40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a240eac895da7a029f62c471dcee4c40d">&#9670;&nbsp;</a></span>event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::event </td>
          <td>(</td>
          <td class="paramtype">CuActivityEvent *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive events <em>from the main thread to the CuActivity thread</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>the event. Do not delete e after use. Cumbia will delete it after this method invocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>CuActivity::event</dd></dl>
<dl class="section note"><dt>Note</dt><dd>the body of this method is currently empty </dd></dl>

</div>
</div>
<a id="a8ac712e113c8eed3bbf7db935eada457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac712e113c8eed3bbf7db935eada457">&#9670;&nbsp;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::execute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::execute hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<dl class="section user"><dt>Notes</dt><dd><ul>
<li>subscribe_event for the attribute to read is called on the TangoDevice and the desired event subscription type is requested according to the "rmode" (refresh mode) value in the activity token obtained by getToken</li>
</ul>
If subscribe_event is successful, the client will start receiving events through the Tango::Callback push_event function. If an error occurs here, publishResult is called in order to deliver the error message to the main thread, where a CuDataListener will deal with it.</dd></dl>
<dl class="section user"><dt>note</dt><dd>Typically, if subscribe_event fails, a <a class="el" href="classCuPollingActivity.html" title="an activity to periodically read from Tango. Implements CuContinuousActivity">CuPollingActivity</a> is started as a fallback mode for the reader.</dd></dl>
<p>To learn about the contents of the CuData delivered as result, please see the <a class="el" href="classCuEventActivity.html#a53084b7cc8f9366d09d84e7f55f20dc6" title="receive events from Tango, extract data and post the result on the main thread through publishResult">CuEventActivity::push_event</a> documentation.</p>
<p>See also CuActivity::execute</p>
<dl class="section user"><dt>note</dt><dd>In the <a class="el" href="classCuEventActivity.html#a53084b7cc8f9366d09d84e7f55f20dc6" title="receive events from Tango, extract data and post the result on the main thread through publishResult">CuEventActivity::push_event</a> callback, CuData "event" value is copied from Tango::EventData::event. Here data["event"] is set to "subscribe" to identify the <em>subscribe_event</em> phase (<a class="el" href="classCuTReader.html" title="Low level class to read tango attributes and commands with output arguments.">CuTReader</a> looks for this not to issue an error if subscription fails). </dd></dl>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="a74957e066b57442baaa8302982a8a5c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74957e066b57442baaa8302982a8a5c3">&#9670;&nbsp;</a></span>getType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CuEventActivity::getType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the CuEventActivityType value </p>
<dl class="section return"><dt>Returns</dt><dd>the constant value CuEventActivityType defined in <a class="el" href="classCuEventActivity.html#a1dc111181e0c5b18e7d7053c97c6dffa">CuEventActivity::Type</a> </dd></dl>

<p class="reference">References <a class="el" href="classCuEventActivity.html#a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692">CuEventActivityType</a>.</p>

</div>
</div>
<a id="a8fe09cefefbe4446cf7a0cb0cdec386e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe09cefefbe4446cf7a0cb0cdec386e">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::init hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<dl class="section user"><dt>Notes</dt><dd><ul>
<li>in cumbia-tango, threads are grouped by device </li>
<li>a new omni_thread::ensure_self is created and lives across the entire <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> lifetime to work around a known <a class="el" href="namespaceTango.html">Tango</a> issue that breaks the event reception when the client application subscribes to attributes across different devices </li>
<li><a class="el" href="classCuDeviceFactoryService.html#a8336867c61da31e3058edc3cda837c56" title="Get a device for the given name.">CuDeviceFactoryService::getDevice</a> is called to obtain a reference to a <a class="el" href="namespaceTango.html">Tango</a> device (in the form of <a class="el" href="classTDevice.html">TDevice</a>) </li>
<li><a class="el" href="classTDevice.html">TDevice</a>'s user refrence count is incremented with <a class="el" href="classTDevice.html#a328f5c17e174bebe77698eda47a31e5b">TDevice::addRef</a></li>
</ul>
See also CuActivity::init, execute and onExit </dd></dl>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#a1dd84e95bd0da0e2b07684868f0805f9">CuTangoWorld::fillThreadInfo()</a>.</p>

</div>
</div>
<a id="a1d8ea11150700078091feae1978c0117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d8ea11150700078091feae1978c0117">&#9670;&nbsp;</a></span>matches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CuEventActivity::matches </td>
          <td>(</td>
          <td class="paramtype">const CuData &amp;&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns true if the passed token's <em>src</em> and <em>activity</em> values matche this activity token's <em>src</em> and <em>activity</em> values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>a CuData containg key/value pairs of another activity's token </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the input token's "src" and "activity" values match this token's "src" and "activity" values</dd></dl>
<p>Two CuEventActivities match if the "src" and the "activity" names match. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> "activity" key is set to the "event" value by <a class="el" href="classCuTReader.html" title="Low level class to read tango attributes and commands with output arguments.">CuTReader</a>, so two activities match if they are both <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> and share the same source name. </p>

</div>
</div>
<a id="a85edf01781777eb1dee022bdc2c8d162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85edf01781777eb1dee022bdc2c8d162">&#9670;&nbsp;</a></span>onExit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::onExit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::execute hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<ul>
<li>unsubscribe_event is called for the <a class="el" href="namespaceTango.html">Tango</a> attribute </li>
<li>client reference counter is decreased on the <a class="el" href="classTDevice.html">TDevice</a> (<a class="el" href="classTDevice.html#acda15f17d64a5e005e842ad8a2008f18">TDevice::removeRef</a>) </li>
<li><a class="el" href="classCuDeviceFactoryService.html#a378bda3c747880effc55fc673b7e3457" title="remove the device with the given name from the list and delete the device">CuDeviceFactoryService::removeDevice</a> is called to remove the device from the device factory if the reference count is zero </li>
<li>the result of the operation is <em>published</em> to the main thread through publishResult </li>
<li>the omni_thread::ensure_self instance is deleted</li>
</ul>
<p>See also CuActivity::onExit </p>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#a1dd84e95bd0da0e2b07684868f0805f9">CuTangoWorld::fillThreadInfo()</a>, and <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="a53084b7cc8f9366d09d84e7f55f20dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53084b7cc8f9366d09d84e7f55f20dc6">&#9670;&nbsp;</a></span>push_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::push_event </td>
          <td>(</td>
          <td class="paramtype">Tango::EventData *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>receive events from <a class="el" href="namespaceTango.html">Tango</a>, extract data and post the result on the main thread through publishResult </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>the Tango::EventData passed by the tango callback</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>receive the event </li>
<li>extract data exploiting <a class="el" href="classCuTangoWorld.html">CuTangoWorld</a> utility methods </li>
<li>publishResult with the data extracted and packed in a CuData</li>
</ul>
<dl class="section user"><dt>contents of the CuData delivered by publishResult ("key": value)</dt><dd><ul>
<li>"device": string: the <a class="el" href="namespaceTango.html">Tango</a> device name (use CuVariant::toString to convert) </li>
<li>"point": string: the <a class="el" href="namespaceTango.html">Tango</a> point (command or attribute name) (CuVariant::toString) </li>
<li>"is_command": bool: true if the source is a command, false if it is an attribute (CuVariant::toBool) </li>
<li>"err": bool: true if an error occurred, false otherwise </li>
<li>"mode": string: the read mode: "event" or "polled" ("event" in this case) </li>
<li>"rmode": string: the type of event refresh mode as produced by <a class="el" href="classCuTReader.html#aa1c2c0d8e8be6c4562f3336e0fc86d4d">CuTReader::refreshModeStr</a> </li>
<li>"msg": string: a message describing the read operation/data extraction and its success/failure </li>
<li>"event": string: a copy of the value of Tango::EventData::event string (documented as <em>the event name</em> in lib/cpp/client/event.h) </li>
<li>refer to md_lib_cudata_for_tango for a complete description of the CuData key/value pairs that result from attribute or command read operations. </li>
</ul>
</dd></dl>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#aa51e5b7d3ff44e216905f78ed236138e">CuTangoWorld::error()</a>, <a class="el" href="classCuTangoWorld.html#a7bcdb5010031633aa4a702e134665181">CuTangoWorld::extractData()</a>, <a class="el" href="classCuTangoWorld.html#a1dd84e95bd0da0e2b07684868f0805f9">CuTangoWorld::fillThreadInfo()</a>, <a class="el" href="classCuTangoWorld.html#af4dbd900a28775aef70f6d0a20a7c38c">CuTangoWorld::getLastMessage()</a>, and <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="ae7229cfb59440313eb7786dd751c22a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7229cfb59440313eb7786dd751c22a3">&#9670;&nbsp;</a></span>repeat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CuEventActivity::repeat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns 0. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a>'s execute is called only once. </p>
<dl class="section return"><dt>Returns</dt><dd>the integer 0</dd></dl>
<dl class="section see"><dt>See also</dt><dd>CuActivity::repeat </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cueventactivity_8h_source.html">cueventactivity.h</a></li>
<li><a class="el" href="cueventactivity_8cpp.html">cueventactivity.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 13 2019 15:30:59 for cumbia-tango by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
