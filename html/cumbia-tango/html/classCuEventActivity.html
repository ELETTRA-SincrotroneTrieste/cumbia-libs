<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cumbia-tango: CuEventActivity Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cumbia-tango<span id="projectnumber">&#160;1.x</span>
   </div>
   <div id="projectbrief">C++ multi threaded library based on cumbia and the Tango control system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classCuEventActivity-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">CuEventActivity Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>an activity to subscribe and receive events from <a class="el" href="namespaceTango.html">Tango</a>. Implements CuActivity and Tango::Callback interfaces  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cueventactivity_8h_source.html">cueventactivity.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CuEventActivity:</div>
<div class="dyncontent">
<div class="center"><img src="classCuEventActivity__inherit__graph.png" border="0" usemap="#aCuEventActivity_inherit__map" alt="Inheritance graph"/></div>
<map name="aCuEventActivity_inherit__map" id="aCuEventActivity_inherit__map">
<area shape="rect" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int..." alt="" coords="50,80,166,107"/>
<area shape="rect" title=" " alt="" coords="5,5,88,32"/>
<area shape="poly" title=" " alt="" coords="69,42,99,78,95,81,65,46"/>
<area shape="rect" title=" " alt="" coords="112,5,229,32"/>
<area shape="poly" title=" " alt="" coords="152,46,121,81,117,78,148,42"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a1dc111181e0c5b18e7d7053c97c6dffa" id="r_a1dc111181e0c5b18e7d7053c97c6dffa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dc111181e0c5b18e7d7053c97c6dffa">Type</a> { <a class="el" href="#a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692">CuEventActivityType</a> = CuActivity::UserAType + 2
 }</td></tr>
<tr class="separator:a1dc111181e0c5b18e7d7053c97c6dffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3881633219db2da0b8ba89f1553fbb33" id="r_a3881633219db2da0b8ba89f1553fbb33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3881633219db2da0b8ba89f1553fbb33">CuEventActivity</a> (const <a class="el" href="classTSource.html">TSource</a> &amp;tso, <a class="el" href="classCuDeviceFactory__I.html">CuDeviceFactory_I</a> *df, const std::string &amp;refreshmo, const CuData &amp;tag, int update_policy)</td></tr>
<tr class="memdesc:a3881633219db2da0b8ba89f1553fbb33"><td class="mdescLeft">&#160;</td><td class="mdescRight">the class constructor that configures the activity event flags  <br /></td></tr>
<tr class="separator:a3881633219db2da0b8ba89f1553fbb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa70c452d4c66cdcd58362e3253fef197" id="r_aa70c452d4c66cdcd58362e3253fef197"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa70c452d4c66cdcd58362e3253fef197">~CuEventActivity</a> ()</td></tr>
<tr class="memdesc:aa70c452d4c66cdcd58362e3253fef197"><td class="mdescLeft">&#160;</td><td class="mdescRight">the class destructor  <br /></td></tr>
<tr class="separator:aa70c452d4c66cdcd58362e3253fef197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74957e066b57442baaa8302982a8a5c3" id="r_a74957e066b57442baaa8302982a8a5c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74957e066b57442baaa8302982a8a5c3">getType</a> () const</td></tr>
<tr class="memdesc:a74957e066b57442baaa8302982a8a5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the CuEventActivityType value  <br /></td></tr>
<tr class="separator:a74957e066b57442baaa8302982a8a5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a240eac895da7a029f62c471dcee4c40d" id="r_a240eac895da7a029f62c471dcee4c40d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a240eac895da7a029f62c471dcee4c40d">event</a> (CuActivityEvent *e)</td></tr>
<tr class="memdesc:a240eac895da7a029f62c471dcee4c40d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive events <em>from the main thread to the CuActivity thread</em>.  <br /></td></tr>
<tr class="separator:a240eac895da7a029f62c471dcee4c40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8ea11150700078091feae1978c0117" id="r_a1d8ea11150700078091feae1978c0117"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d8ea11150700078091feae1978c0117">matches</a> (const CuData &amp;token) const</td></tr>
<tr class="memdesc:a1d8ea11150700078091feae1978c0117"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true if the passed token's <em>src</em> and <em>activity</em> values matche this activity token's <em>src</em> and <em>activity</em> values.  <br /></td></tr>
<tr class="separator:a1d8ea11150700078091feae1978c0117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7229cfb59440313eb7786dd751c22a3" id="r_ae7229cfb59440313eb7786dd751c22a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7229cfb59440313eb7786dd751c22a3">repeat</a> () const</td></tr>
<tr class="memdesc:ae7229cfb59440313eb7786dd751c22a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns 0. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a>'s execute is called only once.  <br /></td></tr>
<tr class="separator:ae7229cfb59440313eb7786dd751c22a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8fe09cefefbe4446cf7a0cb0cdec386e" id="r_a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8fe09cefefbe4446cf7a0cb0cdec386e">init</a> ()</td></tr>
<tr class="memdesc:a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::init hook  <br /></td></tr>
<tr class="separator:a8fe09cefefbe4446cf7a0cb0cdec386e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac712e113c8eed3bbf7db935eada457" id="r_a8ac712e113c8eed3bbf7db935eada457"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ac712e113c8eed3bbf7db935eada457">execute</a> ()</td></tr>
<tr class="memdesc:a8ac712e113c8eed3bbf7db935eada457"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::execute hook  <br /></td></tr>
<tr class="separator:a8ac712e113c8eed3bbf7db935eada457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85edf01781777eb1dee022bdc2c8d162" id="r_a85edf01781777eb1dee022bdc2c8d162"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85edf01781777eb1dee022bdc2c8d162">onExit</a> ()</td></tr>
<tr class="memdesc:a85edf01781777eb1dee022bdc2c8d162"><td class="mdescLeft">&#160;</td><td class="mdescRight">the implementation of the CuActivity::onExit hook  <br /></td></tr>
<tr class="separator:a85edf01781777eb1dee022bdc2c8d162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53084b7cc8f9366d09d84e7f55f20dc6" id="r_a53084b7cc8f9366d09d84e7f55f20dc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53084b7cc8f9366d09d84e7f55f20dc6">push_event</a> (Tango::EventData *)</td></tr>
<tr class="memdesc:a53084b7cc8f9366d09d84e7f55f20dc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">receive events from <a class="el" href="namespaceTango.html">Tango</a>, extract data and post the result on the main thread through publishResult  <br /></td></tr>
<tr class="separator:a53084b7cc8f9366d09d84e7f55f20dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>an activity to subscribe and receive events from <a class="el" href="namespaceTango.html">Tango</a>. Implements CuActivity and Tango::Callback interfaces </p>
<p>Implementing CuActivity, the work is done in the background by the three methods</p>
<ul>
<li>init </li>
<li>execute </li>
<li>onExit</li>
</ul>
<p>They are called from a separate thread. In cumbia-tango, threads are grouped by device. As an implementor of Tango::Callback, events are received through the push_event callback</p>
<p>Apart from the three execution hooks listed above, some other methods have been written to comply with the CuActivityInterface:</p>
<ul>
<li>getType, returning CuEventActivityType </li>
<li>event, to receive CuActivityEvent events </li>
<li>matches, that returns true if the input token represents an activity like this </li>
<li>repeat, that in this case always returns false</li>
</ul>
<dl class="section user"><dt>note</dt><dd>To solve a known <a class="el" href="namespaceTango.html">Tango</a> issue that prevents events from working if the client application subscribes to sources across different devices, an instance of omni_thread::ensure_self is kept alive as long as the <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> lives. </dd></dl>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a1dc111181e0c5b18e7d7053c97c6dffa" name="a1dc111181e0c5b18e7d7053c97c6dffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc111181e0c5b18e7d7053c97c6dffa">&#9670;&#160;</a></span>Type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a1dc111181e0c5b18e7d7053c97c6dffa">CuEventActivity::Type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692" name="a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692"></a>CuEventActivityType&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3881633219db2da0b8ba89f1553fbb33" name="a3881633219db2da0b8ba89f1553fbb33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3881633219db2da0b8ba89f1553fbb33">&#9670;&#160;</a></span>CuEventActivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CuEventActivity::CuEventActivity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTSource.html">TSource</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>tso</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCuDeviceFactory__I.html">CuDeviceFactory_I</a> *</td>          <td class="paramname"><span class="paramname"><em>df</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>refreshmo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CuData &amp;</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>update_policy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the class constructor that configures the activity event flags </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>a CuData that will identify this activity </td></tr>
    <tr><td class="paramname">df</td><td>a pointer to a <a class="el" href="classCuDeviceFactoryService.html" title="implements CuServiceI interface and provides a service to create and store Tango devices (wrapped by ...">CuDeviceFactoryService</a> that is used by init and onExit to create/obtain and later get rid of a <a class="el" href="namespaceTango.html">Tango</a> device, respectively.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Default activity flags</dt><dd>The default activity flags set by the <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> constructor are</dd></dl>
<ul>
<li>CuActivity::CuAUnregisterAfterExec: <em>false</em>: the activity is not unregistered after exec. Instead, it keeps living within an event loop that delivers <a class="el" href="namespaceTango.html">Tango</a> events over time </li>
<li>CuActivity::CuADeleteOnExit: <em>true</em> lets the activity be deleted after onExit </li>
</ul>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#aa6bd6a9cad6735d1a1b96f166afe7e7caed6842522abf1b3fa3500eab19150f8e">CuTangoWorld::ExtractDefault</a>, and <a class="el" href="cudataupdatepolicy__enum_8h.html#a4d9c283ae81af5da982ba5d929b2d195a41b3171ad4cfe59cfab931d23e70445e">SkipFirstReadUpdate</a>.</p>

</div>
</div>
<a id="aa70c452d4c66cdcd58362e3253fef197" name="aa70c452d4c66cdcd58362e3253fef197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa70c452d4c66cdcd58362e3253fef197">&#9670;&#160;</a></span>~CuEventActivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CuEventActivity::~CuEventActivity </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the class destructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a240eac895da7a029f62c471dcee4c40d" name="a240eac895da7a029f62c471dcee4c40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a240eac895da7a029f62c471dcee4c40d">&#9670;&#160;</a></span>event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::event </td>
          <td>(</td>
          <td class="paramtype">CuActivityEvent *</td>          <td class="paramname"><span class="paramname"><em>e</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive events <em>from the main thread to the CuActivity thread</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>the event. Do not delete e after use. Cumbia will delete it after this method invocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>CuActivity::event</dd></dl>
<dl class="section note"><dt>Note</dt><dd>the body of this method is currently empty </dd></dl>

</div>
</div>
<a id="a8ac712e113c8eed3bbf7db935eada457" name="a8ac712e113c8eed3bbf7db935eada457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac712e113c8eed3bbf7db935eada457">&#9670;&#160;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::execute </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::execute hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<dl class="section user"><dt>Notes</dt><dd><ul>
<li>subscribe_event for the attribute to read is called on the TangoDevice and the desired event subscription type is requested according to the "rmode" (refresh mode) value in the activity token obtained by getToken</li>
</ul>
If subscribe_event is successful, the client will start receiving events through the Tango::Callback push_event function. If an error occurs here, publishResult is called in order to deliver the error message to the main thread, where a CuDataListener will deal with it.</dd></dl>
<dl class="section user"><dt>note</dt><dd>Typically, if subscribe_event fails, a <a class="el" href="classCuPollingActivity.html" title="an activity to periodically read from Tango. Implements CuContinuousActivity">CuPollingActivity</a> is started as a fallback mode for the reader.</dd></dl>
<p>To learn about the contents of the CuData delivered as result, please see the <a class="el" href="#a53084b7cc8f9366d09d84e7f55f20dc6" title="receive events from Tango, extract data and post the result on the main thread through publishResult">CuEventActivity::push_event</a> documentation.</p>
<p>See also CuActivity::execute</p>
<dl class="section user"><dt>note</dt><dd>In the <a class="el" href="#a53084b7cc8f9366d09d84e7f55f20dc6" title="receive events from Tango, extract data and post the result on the main thread through publishResult">CuEventActivity::push_event</a> callback, CuData "E" value is copied from Tango::EventData::event. Here data[TTT::Event] is set to "subscribe" to identify the // data["E"] <em>subscribe_event</em> phase (<a class="el" href="classCuTReader.html" title="Low level class to read tango attributes and commands with output arguments.">CuTReader</a> looks for this not to issue an error if subscription fails). </dd></dl>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="a74957e066b57442baaa8302982a8a5c3" name="a74957e066b57442baaa8302982a8a5c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74957e066b57442baaa8302982a8a5c3">&#9670;&#160;</a></span>getType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CuEventActivity::getType </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the CuEventActivityType value </p>
<dl class="section return"><dt>Returns</dt><dd>the constant value CuEventActivityType defined in <a class="el" href="#a1dc111181e0c5b18e7d7053c97c6dffa">CuEventActivity::Type</a> </dd></dl>

<p class="reference">References <a class="el" href="#a1dc111181e0c5b18e7d7053c97c6dffaaf9260cb4ab297d365436067a921f0692">CuEventActivityType</a>.</p>

</div>
</div>
<a id="a8fe09cefefbe4446cf7a0cb0cdec386e" name="a8fe09cefefbe4446cf7a0cb0cdec386e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe09cefefbe4446cf7a0cb0cdec386e">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::init </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::init hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<dl class="section user"><dt>Notes</dt><dd><ul>
<li>in cumbia-tango, threads are grouped by device </li>
<li>a new omni_thread::ensure_self is created and lives across the entire <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> lifetime to work around a known <a class="el" href="namespaceTango.html">Tango</a> issue that breaks the event reception when the client application subscribes to attributes across different devices </li>
<li><a class="el" href="classCuDeviceFactoryService.html#ac3e693d45e7d74a9b04e39928cf79656" title="Get a device for the given name. Increase reference counter.">CuDeviceFactoryService::getDevice</a> is called to obtain a reference to a <a class="el" href="namespaceTango.html">Tango</a> device (in the form of <a class="el" href="classTDevice.html">TDevice</a>) </li>
<li><a class="el" href="classTDevice.html">TDevice</a>'s user refrence count is incremented with <a class="el" href="classTDevice.html#a328f5c17e174bebe77698eda47a31e5b">TDevice::addRef</a></li>
</ul>
See also CuActivity::init, execute and onExit </dd></dl>

<p class="reference">References <a class="el" href="classCuTThread.html#a89710895b3926289edb7821a118afe06a4483c1e056e0c0f24bdab56f97ced1af">CuTThread::CuTThreadType</a>.</p>

</div>
</div>
<a id="a1d8ea11150700078091feae1978c0117" name="a1d8ea11150700078091feae1978c0117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d8ea11150700078091feae1978c0117">&#9670;&#160;</a></span>matches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CuEventActivity::matches </td>
          <td>(</td>
          <td class="paramtype">const CuData &amp;</td>          <td class="paramname"><span class="paramname"><em>token</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns true if the passed token's <em>src</em> and <em>activity</em> values matche this activity token's <em>src</em> and <em>activity</em> values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>a CuData containg key/value pairs of another activity's token </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the input token's TTT::Src and "activity" values match this token's TTT::Src and "activity" values</dd></dl>
<p>Two CuEventActivities match if the TTT::Src and the "activity" names match. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> "activity" key is set to the "E" value by <a class="el" href="classCuTReader.html" title="Low level class to read tango attributes and commands with output arguments.">CuTReader</a>, so two activities match if they are both <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a> and share the same source name. </p>

</div>
</div>
<a id="a85edf01781777eb1dee022bdc2c8d162" name="a85edf01781777eb1dee022bdc2c8d162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85edf01781777eb1dee022bdc2c8d162">&#9670;&#160;</a></span>onExit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::onExit </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the implementation of the CuActivity::onExit hook </p>
<p>This is called in the CuActivity's thread of execution.</p>
<ul>
<li>unsubscribe_event is called for the <a class="el" href="namespaceTango.html">Tango</a> attribute </li>
<li>client reference counter is decreased on the <a class="el" href="classTDevice.html">TDevice</a> (<a class="el" href="classTDevice.html#acda15f17d64a5e005e842ad8a2008f18">TDevice::removeRef</a>) </li>
<li>CuDeviceFactoryService::removeDevice is called to remove the device from the device factory if the reference count is zero </li>
<li>publishResult is not called (it's likely that all listeners have been removed) </li>
<li>the omni_thread::ensure_self instance is deleted</li>
</ul>
<p>See also CuActivity::onExit </p>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="a53084b7cc8f9366d09d84e7f55f20dc6" name="a53084b7cc8f9366d09d84e7f55f20dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53084b7cc8f9366d09d84e7f55f20dc6">&#9670;&#160;</a></span>push_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CuEventActivity::push_event </td>
          <td>(</td>
          <td class="paramtype">Tango::EventData *</td>          <td class="paramname"><span class="paramname"><em>e</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>receive events from <a class="el" href="namespaceTango.html">Tango</a>, extract data and post the result on the main thread through publishResult </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>the Tango::EventData passed by the tango callback</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>receive the event </li>
<li>extract data exploiting <a class="el" href="classCuTangoWorld.html">CuTangoWorld</a> utility methods </li>
<li>publishResult with the data extracted and packed in a CuData</li>
</ul>
<dl class="section user"><dt>contents of the CuData delivered by publishResult ("key": value)</dt><dd><ul>
<li>"is_command": bool: true if the source is a command, false if it is an attribute (CuVariant::toBool) </li>
<li>TTT::Err: bool: true if an error occurred, false otherwise </li>
<li>"mode": string: the read mode: "E" or "P" ("E" in this case) </li>
<li>TTT::Message: string: in case of error, the error message is reported </li>
<li>"E": string: a copy of the value of Tango::EventData::event string (documented as <em>the event name</em> in lib/cpp/client/event.h) </li>
<li>refer to md_lib_cudata_for_tango for a complete description of the CuData key/value pairs that result from attribute or command read operations. </li>
</ul>
</dd></dl>

<p class="reference">References <a class="el" href="classCuTangoWorld.html#aa51e5b7d3ff44e216905f78ed236138e">CuTangoWorld::error()</a>, <a class="el" href="classCuTangoWorld.html#a9b36a6e482845c5c0764d0dfde7707b6">CuTangoWorld::extractData()</a>, <a class="el" href="classCuTangoWorld.html#af4dbd900a28775aef70f6d0a20a7c38c">CuTangoWorld::getLastMessage()</a>, and <a class="el" href="classCuTangoWorld.html#a26e156a6270b77593eec59508575eb9f">CuTangoWorld::strerror()</a>.</p>

</div>
</div>
<a id="ae7229cfb59440313eb7786dd751c22a3" name="ae7229cfb59440313eb7786dd751c22a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7229cfb59440313eb7786dd751c22a3">&#9670;&#160;</a></span>repeat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CuEventActivity::repeat </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns 0. <a class="el" href="classCuEventActivity.html" title="an activity to subscribe and receive events from Tango. Implements CuActivity and Tango::Callback int...">CuEventActivity</a>'s execute is called only once. </p>
<dl class="section return"><dt>Returns</dt><dd>the integer -1</dd></dl>
<dl class="section see"><dt>See also</dt><dd>CuActivity::repeat </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cueventactivity_8h_source.html">cueventactivity.h</a></li>
<li><a class="el" href="cueventactivity_8cpp.html">cueventactivity.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 16 2024 16:58:16 for cumbia-tango by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
