<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cumbia: news</title>
<link href="html/cumbia/html/tabs.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<h1>News</h1>

<h2>Important note</h2>

<p>
Since version 1.3.0 <em>the news page will be replaced by <strong>CHANGELOG.md</strong>.</em>
It can be found both in the cumbia-libs project root and
<a href="https://elettra-sincrotronetrieste.github.io/cumbia-libs/CHANGELOG.md">here</a>.

</p>
<p>
The *cumbia-libs* main project version may be more up to date!
</p>

<h2>version 1.3.0</h2>

<p>
Changes in 1.3.0 shall provide an enhanced performance and brings a lighter and more readable code in cumbia-tango.
</p>

<h4>cumbia</h4>

<p>
<ul>
<li>cumbia: shortcuts for common conversion methods have been introduced in CuData:
for example d.b("key") is the equivalent of d["key"].toBool() and d.s("src") is the
equivalent of d["src"].toString().

<br/>
The upper case versions: d.B(const std::string& key), d.D(const std::string& key) are shortcuts for
the template conversion
flavours provided by CuVariant.  See CuData documentation.

<br/>
Matching methods have been introduced in CuVariant.

</li>

<li>
cumbia: CuMatrix new class is a model for 2 dimensional arrays. See CuMatrix doc.
CuVariant constructors have been added for the supported types, given a vector and
the number of rows and columns.
Template function CuVariant::toMatrix<T> converts a CuVariant matrix to a matrix
of type T
</li>

<li>
cumbia: CuVariant vector of char and unsigned char support added
</li>

<li>
cumbia: both CuVariant string and vector of strings conversion now can optionally
take a parameter specifying the  desired <em>conversion format</em>,
printf - style.
</li>

<li>
cumbia: if an EventLoopService is specified upon timer creation, CuTimer will
post timer events on the event loop service thread (typically, the main thread).
</li>

</ul>

<h4>cumbia-tango</h4>

<ul>
<li>
cumbia-tango: CuTReader code has been cleaned and a memory leak regression has been fixed.
</li>

<li>
cumbia applications: use <em>cu_exclude_engines</em> variable to <em>qmake</em> to
list the engines you <em>do not want to enable</em> in the application.
<br/>
For example:<br/>
 <strong>qmake cu_exclude_engines="websocket epics random"</strong>

disables support for cumbia-websocket, cumbia-epics and cumbia-random

</li>

</ul>

</p>

<h2>version 1.2.4</h2>

<p>

<ul>
<li>
cumbia-tango: CuTConfigActivity: if option "no-value" is found and set to true, then
              neither command_inout nor read_attribute are performed during configuration.

              Fixed to<bool> conversion in CuTConfigActivity that may prevent proper readers configuration

              Removed "action_ptr" information in polling related CuData. CuPollingActivity action_data internal map stores std::string
	      --> ActionData instead of ptr
</li>
<li>
cumbia-http: CuHttpControlsWriter.setTarget and CuHttpControlsReader.setSource set option "read-value" to true on CuHTTPActionConfFactory
             when it is safe to execute command_inout during configuration. Fixes a bug that
	     caused command_inout to be imparted during writer configuration.
	     In principle, "read-value" set to true should apply only to commands, and should not be necessary when dealing with attributes.
	     This must be dealt on the server side. When this is fixed, then the property could be "do-cmd-read" or something else
	     to have a proper meaning
</li>
<li>
cumbia-qtcontrols: NumberDelegate/DecIntFromFormat:
                without "min" and "max" properties in the configuration stage, the "format" is used to configure writers (applies to
		quinputoutput, quapplynumeric)

                QuWatcher: added convenience class Qu1TWatcher, one time, auto destroying QuWatcher

</li>

<li>
qumbia-tango-controls: under examples, a new test application named "writers_format_test" to test cumbia-qtcontrols numeric widgets
                configuration with format and without min and max properties

</li>
</p>


<h2>version 1.2.3</h2>

<p>
Version <em>1.2.3</em> keeps improving cross engine transparency introducing <em>sources</em> that fetch
Tango database properties.
Numerous small issues have been fixed and a new feature for the Tango (and the http) engines allows changing
source <cite>arguments</cite> in (polled) commands on the fly through a lightweight call to CuContext::sendData.
</p>

<h3>Tango database support in setSource</h3>
<p>
Support for Tango database readings has been added by means of setSource.
</p>
<h3>sendData supports the "args" key to change the source arguments while reading (Tango, http)</h3>
<p>
getContext()->sendData() supports an "args" parameter to change the source arguments for readers
</p>
<h5>Example</h5>
<ul>
<li>qumbia-tango-controls/examples/editargs</li>
</ul>


<h2>version 1.2.0</h2>

The cumbia version 1.2.0 moves definitely towards the application portability and aims at broader integration
across several engines (that translates into <em>cumbia modules</em>).
Alongside the <em>websocket</em> integration, cumbia 1.2.0 introduces initial support to <em>http and
Server Sent Events</em> technologies, looking forward to such services becoming available soon.
Applications written in any language will thus be enabled to connect to native control system engines from
<em>anywhere</em>.

<h3>New quapps.pri project include file</h3>
<p>
The <em>qumbia-apps</em> module includes a new <em>quapps</em> utility that offers automatic
cumbia module (engine) detection at application startup.
Just include <strong>quapps.pri</strong> from your <em>path/to/cumbia-libs/include/quapps</em> to use the
CuModuleLoader helper class.
</p>

<h3>Tango Database read access becomes easy!</h3>
<p>
Reading class properties is accomplished by a source like <em>tango://TangoTest(ProjectTitle,Description)</em>
Device properties can be obtained like <em>tango://ken:20000/test/device/1(description, helperApplication,values)</em>,
and get the list of attributes of a device through <em>ken:20000/test/device/1(description, helperApplication,values)</em>
</p>
<p>
Type <br/>
<em>cumbia read --help</em><br/>
and scroll to the section <em>Read the Tango database</em> to play and get acquainted with this new functionality in no time!
</p>
<p>
This new feature allows to get properties in your app with just the little code needed for usual sources, and integrate
them easily in graphical elements.
Have a look at <a href="https://elettra-sincrotronetrieste.github.io/cumbia-libs/html/cumbia-qtcontrols/html/understanding_cumbia_qtcontrols_constructors.html">this</a>
documentation page.
</p>

<h3>cumbia-http</h3>
<p>
Nowadays the need to access control systems from home and portable devices is constantly growing.
The new <em>cumbia-http</em> has been designed with this purpose and http and Server Sent Event services in mind.
When such services become available, clients of any kind will be able to connect from anywhere!
</p><p>
Include <em>cumbia-http</em> in your installation is as easy as adding <strong>http</strong> to the <em>scripts/cubuild.sh</em>
command.
</p>

<h3>CuModuleLoader loader in quapps</h3>
<p>
The new header file provided by *qumbia-apps/quapps* module allows to find and load all
available cumbia engines, depending on optional command line arguments. Thanks to this
and to the flexible cumbia design, it is possible to connect any application to a native
control system engine or let it obtain data through *http* or *websocket*.
</p>

<h3>QTango migration creates a multi engine version of the app</h3>
<p>
The cumbia project wizard now creates a <em>multi engine</em> version of the application when
migrating from a QTango project.
</p>

<h2>version 1.1.1</h2>

<h3>cumbia</h3>
<ul>
<li>CumbiaPool: removed printf when no implementation is found and improved doc</li>
<li>Support for cross compilation with emscripten / wasm</li>
</ul>

<h3>cumbia-qtcontrols</h3>
<ul>
<li>CuControlsFactoryPool: NULL replaced with nullptr.</li>
<li> A QuReplaceWildcards_I definition has been introduced to provide an interface for command line *replace wildcards* capable
    engines.</li>
<li> Support for cross compilation with emscripten / wasm</li>
</ul>

<h3>qumbia-apps</h3>
<ul>
<li>qumbia-read: support for websocket</li>
</ul>
<ul>qumbiaprojectwizard:
<li>fixed $APPLICATION_NAME$" and "$ORGANIZATION_NAME$" placeholder replacement</li>
<li>multi-engine is the default option and the templates create a skeleton including cumbia-random and cumbia-websocket modules,
     if available. cumbia-websocket is added only if a proper command line option is detected. QCommandLineParser is used to find
     the required option to activate cumbia-websocket connection</li>
</ul>

<h3>cumbia-websocket</h3>
<ul>
<li>added support for a full-duplex communication with generic server on a single web socket.
    Former support to canoned (pwma) server is maintained and selected if an http url is provided
    to the constructor alongside the websocket URL.</li>
<li>d1. can be tested using the simple https://github.com/ELETTRA-SincrotroneTrieste/cumbia-websocket-proxy-server.git
    websocket server "proxy"</li>
<li>added support for command line argument wildcard replacement for tango by an implementation of QuReplaceWildcards_I</li>
</ul>

<h3>qumbia-tango-controls</h3>
<ul>
<li>cutcontrols-utils:  CuTangoReplaceWildcards implementation of the QuReplaceWildcards_I interface is used to perform
    command line arguments wildcard replacement</li>
</ul>

<h2>version 1.1.0</h2>


<h2>App: cumbia read</h2>
<p>
<a href="html/qumbia-reader/html/index.html">cumbia read</a> has been expanded in order to support the cumbia-random module and a
great number of command line options.
Coupled with the qumbia-tango-findsrc-plugin and the qumbia-tango-find-src app, that can be installed from
<a href="https://github.com/ELETTRA-SincrotroneTrieste/qumbia-tango-findsrc-plugin.git">github</a>.
it provides <cite>Tango sources auto completion</cite> on the command line.
</p>
<h3>Try it out!</h3>

<p>
<cite>Hint</cite>: hit the <em>TAB</em> key to auto complete Tango source names.
</p>

<style>

  table {
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid orange;
    padding: 10px;
    text-align: left;
  }
</style>

<table>
<tr><th>description</th><th>command</th></tr>
<tr><td>read sources from heterogeneous engines</td>
<td>cumbia read test/device/1/double_scalar epics:ai1 random://rnd/1/0/10  </td> </tr>
<tr><td>read sources configuration only, from heterogeneous engines</td>
<td>cumbia read test/device/1/double_scalar epics:ai1 --property </tr>
<tr><td>Impart a Tango command to read an array three times, truncate the output to 8 elements, print with a custom format</td>
<td>cumbia read inj/diagnostics/rtbpm_inj.01//GetHorPos[0,1000] --truncate=8 --3 --format="%.4f" </tr>
<tr><td>Monitor a Tango command</td>
<td>cumbia monitor inj/diagnostics/rtbpm_inj.01//GetHorPos[0,1000] --truncate=8</td> </tr>
<tr><td>Filtered list of Tango device properties</td>
<td>cumbia read --tp  test/device/1:helper*  </td></tr>
<tr><td>Read a Tango attribute property</td>
<td>cumbia read --tp test/device/1/string_scalar/values  </td></tr>
</table>

<p>
More examples <a href="html/qumbia-reader/html/index.html">here</a>.
</p>

<p>
Additional features:
<ul>
<li>customizable output detail level</li>
<li>support for Tango database properties (device, attribute, class)</li>
<li>either monitor or single shot mode</li>
See the documentation for a more detailed description.
</ul>
</p>

<h2>Library</h2>

<h3>New prerequisites</h3>
<p>
    The read/write locks adopted to provide greater speed require a compiler supporting the <em>C<li><li> 17</em> standard.
</p>

<h3> cumbia </h3>
<p>
Version 1.1.0 allows the application developer to customize how threads are grouped together, as well
as to define an upper limit on their number. The *cumbia-tango* engine groups threads by Tango device.
If you want to customize the default behaviour, refer to the
<a href="html/cumbia-tango/html/classCuTThreadTokenGen.html">CuTThreadTokenGen</a> and the
<a href="html/cumbia/html/classCumbia.html#ad1294d5af961ea0899aabf299e7f2c56">Cumbia::setThreadTokenGenerator</a>
documentation pages.
Additionally, timers in polled reads can be reused in order to limit timer threads.
See the <a href="html/cumbia/html/classCuTimerService.html">CuTimerService</a> documentation.
</p>

<h3>cumbia-tango</h3>
<h4>Database search
<p>
CuTdbPropertyReader
<ul>
<li>added support for wildcards when searching device properties</li>
<li>added Tango class property list for a given class name</li>
</ul>
</p>

<h3>cumbia-random</h3>
<p>
<a href="html/cumbia-random/html/index.html">cumbia-random</a>
has been expanded in order to offer great flexibility to test higher level cumbia modules
and applications with greater accuracy. Source names alone can specify how data is generated, threads grouped and much more. JavaScript
functions in .js files can be set as source of data for the cumbia-random module.
</p>
<ul>
<li>The source name can define group threading, period, size of generated data, minimum, maximum and period.</li>
<li>The source can specify a JavaScript file to generate data from a custom function</li>
</ul>

<h3>cumbia-qtcontrols</h3>
<p>
CuPluginLoader provides a template method to quickly obtain an instance of the desired plugin. See
<a href="html/cumbia-qtcontrols/html/classCuPluginLoader.html">CuPluginLoader</a>::get.
</p>


<h2>Plugins</h2>
<h3>qumbia-tango-findsrc-plugin</h3>
<p>
 An external new plugin named qumbia-tango-findsrc-plugin and the qumbia-tango-find-src app are available from
   <a href="https://github.com/ELETTRA-SincrotroneTrieste/qumbia-tango-findsrc-plugin.git">github.com</a>
   The utility finds the name of a Tango source (attribute or command) from a partial name.
   <em>The plugin can be loaded from any application willing to provide <strong>Tango sources auto completion</strong></em>.
</p>


</body>
